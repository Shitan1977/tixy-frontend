{% extends "web/base.html" %}
{% load static %}

{% block title %}Tutti i rivenditori | Tixy{% endblock %}

{% block content %}
<div class="site-breadcrumb" style="background-image:url('{% static 'assets/img/breadcrumb/01.jpg' %}')">
  <div class="container">
    <h2 class="breadcrumb-title">Tutti i rivenditori</h2>
    <ul class="breadcrumb-menu">
      <li><a href="{% url 'home' %}">Home</a></li>
      <li class="active">Rivenditori</li>
    </ul>
  </div>
</div>

<main class="main pt-60 pb-80">
  <div class="container">
    <div class="site-heading-inline mb-3">
      <h2 class="site-title">Tutti i rivenditori</h2>
      <div class="text-muted">{{ count|default:0 }} risultati</div>
    </div>

    {% if items %}
      <div class="row g-4">
        {% for it in items %}
          <div class="col-12 col-md-6 col-lg-4">
            <article class="seller-card h-100">
              <div class="d-flex justify-content-between align-items-start">
                <h5 class="m-0">{{ it.name }}</h5>
                {% if it.rating %}
                  <div class="small text-nowrap">
                    <i class="far fa-star"></i> {{ it.rating|floatformat:2 }}
                    {% if it.reviews %}<span class="text-muted">({{ it.reviews }})</span>{% endif %}
                  </div>
                {% endif %}
              </div>

              <ul class="seller-tags mt-2">
                {% if it.listings_count %}
                  <li class="chip"><i class="far fa-ticket"></i> Annunci: {{ it.listings_count }}</li>
                {% endif %}
              </ul>

              <div class="mt-3 text-end">
                <!-- Non avendo un filtro server per seller, cerchiamo per nome -->
                <a class="theme-btn theme-btn-sm" href="{% url 'search' %}?q={{ it.name|urlencode }}">
                  <i class="far fa-cart-shopping"></i> Vedi biglietti
                </a>
              </div>
            </article>
          </div>
        {% endfor %}
      </div>

      {% if pages > 1 %}
        <nav class="mt-4 d-flex justify-content-between align-items-center">
          <a class="btn btn-outline-secondary {% if not has_prev %}disabled{% endif %}" href="?page={{ prev_page }}">« Precedente</a>
          <span class="text-muted">Pagina {{ page }} / {{ pages }}</span>
          <a class="btn btn-outline-secondary {% if not has_next %}disabled{% endif %}" href="?page={{ next_page }}">Successiva »</a>
        </nav>
      {% endif %}
    {% else %}
      <p class="text-muted">Nessun rivenditore trovato.</p>
    {% endif %}
  </div>
</main>
{% endblock %}
