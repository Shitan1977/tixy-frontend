{% extends "web/base.html" %}
{% load static %}

{% block title %}Date evento | Tixy{% endblock %}

{% block content %}
<!-- BREADCRUMB -->
<div class="site-breadcrumb" style="background-image:url('{% static "assets/img/breadcrumb/01.jpg" %}')">
  <div class="container">
    <h2 class="breadcrumb-title">{{ evento.nome_evento|default:"Evento" }}</h2>
    <ul class="breadcrumb-menu">
      <li><a href="{% url "home" %}">Home</a></li>
      <li class="active">Date evento</li>
    </ul>
  </div>
</div>

<main class="main">

  <!-- BLOCCO PRINCIPALE (evento + data principale) -->
  <section class="pt-60 pb-20">
    <div class="container">
      <div class="seller-card" style="padding:22px;">
        <div class="d-flex flex-wrap justify-content-between align-items-start gap-2">
          <div>
            <h3 class="seller-title mb-1">
              {{ main_date.evento_nome|default:evento.nome_evento|default:"Evento" }}
            </h3>

            <div class="small seller-sub">
              {% if main_date and main_date.luogo_nome %}
                <i class="far fa-location-dot me-1"></i>{{ main_date.luogo_nome }}
              {% endif %}

              {% if main_date and main_date.starts_fmt %}
                <span class="ms-2">
                  <i class="far fa-calendar-days me-1"></i><strong>{{ main_date.starts_fmt }}</strong>
                </span>
              {% endif %}
            </div>

            <div class="small text-muted mt-1">
              Trovate <strong>{{ count|default:0 }}</strong> date
            </div>
          </div>

          <div class="text-end ms-auto">
            {% if main_date %}
              <a href="{% url 'event-listings' main_date.id %}" class="theme-btn theme-btn-sm">
                <i class="far fa-ticket"></i> Vedi biglietti
              </a>
            {% endif %}
          </div>
        </div>

        {% if error %}
          <div class="alert alert-danger mt-3 mb-0">
            Errore: {{ error }}
          </div>
        {% endif %}
      </div>
    </div>
  </section>

  <!-- ALTRE DATE -->
  <section class="py-20 pb-40">
    <div class="container">

      <div class="seller-card mb-3" style="padding:18px;">
        <h5 class="mb-0">Altre date</h5>
      </div>

      <div class="row g-3">

        {% for p in other_dates %}
          <div class="col-12">
            <article class="seller-card hover-shadow">
              <div class="d-flex flex-wrap justify-content-between align-items-start gap-3">
                <div>
                  <div class="mb-1">
                    <strong class="seller-title">
                      {{ p.evento_nome|default:"Evento" }}
                    </strong>
                  </div>

                  <div class="small seller-sub">
                    {% if p.luogo_nome %}
                      <i class="far fa-location-dot me-1"></i>{{ p.luogo_nome }}
                    {% endif %}
                    {% if p.starts_fmt %}
                      <span class="ms-2">
                        <i class="far fa-calendar-days me-1"></i>{{ p.starts_fmt }}
                      </span>
                    {% endif %}
                  </div>
                </div>

                <div class="text-end ms-auto">
                  <a href="{% url 'event-listings' p.id %}" class="theme-btn theme-btn-sm">
                    <i class="far fa-cart-shopping"></i> Vedi biglietti
                  </a>
                </div>
              </div>

              <ul class="seller-tags mt-2">
                <li class="chip"><i class="far fa-ticket"></i> Performance ID: {{ p.id }}</li>
                {% if p.starts_iso %}
                  <li class="chip"><i class="far fa-clock"></i> {{ p.starts_fmt }}</li>
                {% endif %}
              </ul>

            </article>
          </div>
        {% empty %}
          <div class="col-12">
            <div class="alert alert-info">
              Nessuna data futura trovata per questo evento.
            </div>
          </div>
        {% endfor %}

      </div>
    </div>
  </section>

</main>
{% endblock %}
